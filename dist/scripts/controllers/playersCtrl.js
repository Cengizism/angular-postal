define(["controllers/controllers","config"],function(e,t){e.controller("playersCtrl",["$scope","$timeout",function(e,n){e.positions=t.app.positions,e.player={},e.players=[],e.teams=[];var r=e.$bus.channel("players"),i=e.$bus.channel("teams");n(function(){i.publish("team.list",function(t){e.teams=t})}),r.subscribe("player.team.list",function(){i.publish("team.list",function(t){e.teams=t})}),e.Player={list:function(){e.promised="Loading promised..",r.request({topic:"player.promised.list",timeout:2}).then(function(t){e.players=t.list,e.promised="data loaded"},function(t){e.promised="Uh oh! Error: "+t})},save:function(t){r.publish({topic:"player.save",data:{player:t,callback:function(){this.list()}.bind(this)}}),e.player={}},remove:function(e){r.publish({topic:"player.remove",data:{id:e,callback:function(){this.list()}.bind(this)}})},edit:function(t){e.player=angular.extend({},t)}},n(function(){e.Player.list()}),e.clearForm=function(){e.player={}}}])});